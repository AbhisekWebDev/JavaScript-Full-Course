<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <p>
        <b>AJAX - The XMLHttpRequest Object</b> <br>
        The keystone of AJAX is the XMLHttpRequest object. <br>
        Create an XMLHttpRequest object <br>
        Define a callback function <br>
        Open the XMLHttpRequest object <br>
        Send a Request to a server
    </p>
    <br>
    <div id="result">
        <p>Let AJAX change this text.</p>
        <button type="button" onclick="loadDoc()">Change Content</button>
    </div>

    <br>

    <div id="result1">
        <p>Let AJAX change this text. But this time I am using Onreadystatechange and readystate also</p>
        <button type="button" onclick="loadDoc1()">Change Content</button>
    </div>

    <script>
        
    // Create an XMLHttpRequest Object
        // All modern browsers (Chrome, Firefox, IE, Edge, Safari, Opera) have a built-in XMLHttpRequest object.
        // Syntax for creating an XMLHttpRequest object:
        // variable = new XMLHttpRequest();

    
    // Define a Callback Function
        // A callback function is a function passed as a parameter to another function.
        // In this case, the callback function should contain the code to execute when the response is ready.

        // xhttp.onload = function() {

            // What to do when the response is ready

        // }


    // Send a Request
        // To send a request to a server, you can use the open() and send() methods of the XMLHttpRequest object:

        // xhttp.open("GET", "ajax_info.txt");
        // xhttp.send();


        // example -

        // Create an XMLHttpRequest object
        // const xhttp = new XMLHttpRequest();

        // Define a callback function
        // xhttp.onload = function() {

            // Here you can use the Data

        // }

        // Send a request
        // xhttp.open("GET", "ajax_info.txt");
        // xhttp.send();


        function loadDoc() {

            const xhttp = new XMLHttpRequest();

            xhttp.onload = function() {
                document.getElementById("result").innerHTML = this.responseText;
            }

            xhttp.open("GET", "ajax_info.txt");
            xhttp.send();
        }


    // XMLHttpRequest Object Methods

        // Method	                                Description

        // new XMLHttpRequest()	                    Creates a new XMLHttpRequest object
        // abort()	                                Cancels the current request
        // getAllResponseHeaders()	                Returns header information
        // getResponseHeader()	                    Returns specific header information

        // open(	                                Specifies the request
        //      method                                  method: the request type GET or POST
        //      url                                     url: the file location
        //      async                                   async: true (asynchronous) or false (synchronous)
        //      user                                    user: optional user name
        //      psw)                                    psw: optional password

        // send()	                                Sends the request to the server Used for GET requests
        // send(string)	                            Sends the request to the server Used for POST requests
        // setRequestHeader()	                    Adds a label/value pair to the header to be sent


    // XMLHttpRequest Object Properties

        // Property	                                Description

        // onload	                                Defines a function to be called when the request is received (loaded)
        // onreadystatechange	                    Defines a function to be called when the readyState property changes

        // readyState	                            Holds the status of the XMLHttpRequest.
        //                                              0: request not initialized
        //                                              1: server connection established
        //                                              2: request received
        //                                              3: processing request
        //                                              4: request finished and response is ready

        // responseText	                            Returns the response data as a string
        // responseXML	                            Returns the response data as XML data

        // status	                                Returns the status-number of a request
        //                                              200: "OK"
        //                                              403: "Forbidden"
        //                                              404: "Not Found"
        //                                              For a complete list go to the Http Messages Reference

        // statusText	                            Returns the status-text (e.g. "OK" or "Not Found")


    // Multiple Callback Functions
        // If you have more than one AJAX task in a website, you should create one function for executing the XMLHttpRequest object, and one callback function for each AJAX task.
        // The function call should contain the URL and what function to call when the response is ready.

        // example - 

        // loadDoc("url-1", myFunction1);

        // loadDoc("url-2", myFunction2);

        //  function loadDoc(url, cFunction) {
        //      const xhttp = new XMLHttpRequest();
        //      xhttp.onload = function() {cFunction(this);}
        //      xhttp.open("GET", url);
        //      xhttp.send();
        //  }

        //  function myFunction1(xhttp) {
        //       action goes here
        //  }

        //  function myFunction2(xhttp) {
        //      action goes here
        //  }


    // The onreadystatechange Property
        // The readyState property holds the status of the XMLHttpRequest.
        // The onreadystatechange property defines a callback function to be executed when the readyState changes.
        // The status property and the statusText properties hold the status of the XMLHttpRequest object.

        // The onreadystatechange function is called every time the readyState changes.
        // When readyState is 4 and status is 200, the response is ready:


        function loadDoc1 () {

            const xhttp1 = new XMLHttpRequest();

            xhttp1.onreadystatechange = function() {
                if(this.readyState == 4 && this.status == 200) {
                    document.getElementById("result1").innerHTML = this.responseText;
                }
            }

            xhttp1.open("GET", "ajax_info.txt");
            xhttp1.send();
        }
    
    </script>
</body>
</html>